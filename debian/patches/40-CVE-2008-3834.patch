diff --git a/dbus/dbus-marshal-validate-util.c b/dbus/dbus-marshal-validate-util.c
index f2901d7..5365d6d 100644
--- a/dbus/dbus-marshal-validate-util.c
+++ dbus-1.0.2/dbus/dbus-marshal-validate-util.c
@@ -228,6 +228,7 @@ _dbus_marshal_validate_test (void)
     "123",
     ".",
     "("
+    "a{(ii)i}" /* https://bugs.freedesktop.org/show_bug.cgi?id=17803 */
   };
 
   /* Signature with reason */
diff --git a/dbus/dbus-marshal-validate.c b/dbus/dbus-marshal-validate.c
index e63a463..b24b5bc 100644
--- a/dbus/dbus-marshal-validate.c
+++ dbus-1.0.2/dbus/dbus-marshal-validate.c
@@ -247,6 +247,7 @@ _dbus_validate_signature_with_reason (const DBusString *type_str,
         }
 
       if (last == DBUS_DICT_ENTRY_BEGIN_CHAR &&
+          _dbus_type_is_valid (*p) &&
           !dbus_type_is_basic (*p))
         {
           result = DBUS_INVALID_DICT_KEY_MUST_BE_BASIC_TYPE;

